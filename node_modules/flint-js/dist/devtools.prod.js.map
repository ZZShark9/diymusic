{"version":3,"sources":["webpack:///devtools.prod.js","webpack:///./src/tools/main.js","webpack:///./src/tools/errors.js","webpack:///./src/tools/messages.js","webpack:///./src/lib/flintExt.js","webpack:///./src/tools/socket.js"],"names":["webpackJsonp","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","_errors","_errors2","_messages","_messages2","_eventEmitter","_eventEmitter2","emitter","window","_DT","data","on","name","cb","opts","websocketPort","_FLINT_WEBSOCKET_PORT","flintRuntimeError","message","file","line","col","error","browserData","stack","browser","emit","run","b","onViewLoaded","compileError","loc","fileName","column","lineNumber","compileSuccess","Object","defineProperty","value","undefined","_socket2","editor:location","msg","editorLocation","view:locations","viewLocations","script:add","replaceScript","stylesheet:add","addSheet","view","stylesheet:remove","removeSheet","compile:error","compile:success","packages:reload","reloadScript","internals:reload","reloadAll","file:delete","_ref","views","Flint","getFile","map","removeScript","deleteFile","flint:opts","__flintopts","fromEditor","_ref2","key","val","editor","TagLoader","last","loading","wait","load","onDone","newTag","oldTag","addScript","src","path","replace","send","scrLoad","lastTag","done","finish","document","querySelector","scriptSelector","replaceTag","createScript","cssLoad","findSheet","createSheet","sheetUrl","getParent","tag","parentNode","nodeName","body","head","attr","after","parent","clone","cloneNode","already","cielTimeout","afterFinish","clearTimeout","setTimeout","removeTag","onerror","onload","appendChild","leftover","arguments","length","removeChild","e","isScript","tags","querySelectorAll","sheetSelector","href","i","_tag","id","el","getElementById","reloadAllScripts","renderFlint","_ref3","timestamp","jsName","_libFlintExt2","scripts","_Flint","resetViewState","forEach","call","script","render","renderAttempts","removeBase","str","removeTime","replaceTime","Date","now","createElement","rel","node","tagName","attrs","attributes","setAttribute","getAttribute","findScript","_libFlintExt","_socket","scriptUrl","dots","split","join","socket","_browser","_opts","_actions","actions","open","messageEditor","console","flint","isOpening","ws","WebSocket","onopen","onOpen","onmessage","onMessage","reconnect","onclose","isOpen","reconnecting","JSON","parse","_type","action","close","tries","reconnector","delay","type","stringify"],"mappings":"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","file":"devtools.prod.js","sourcesContent":["webpackJsonp([0],[\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _errors = __webpack_require__(1);\n\t\n\tvar _errors2 = _interopRequireDefault(_errors);\n\t\n\tvar _messages = __webpack_require__(2);\n\t\n\tvar _messages2 = _interopRequireDefault(_messages);\n\t\n\tvar _eventEmitter = __webpack_require__(5);\n\t\n\tvar _eventEmitter2 = _interopRequireDefault(_eventEmitter);\n\t\n\tvar emitter = (0, _eventEmitter2['default'])({});\n\t\n\twindow._DT = {\n\t  emitter: emitter,\n\t  data: null, // should be error\n\t  on: function on(name, cb) {\n\t    emitter.on(name, cb);\n\t  }\n\t};\n\t\n\tvar opts = {\n\t  websocketPort: window._FLINT_WEBSOCKET_PORT\n\t};\n\t\n\t(0, _errors2['default'])(window._DT, opts);\n\t(0, _messages2['default'])(window._DT, opts);\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\texports['default'] = run;\n\texports.compileError = compileError;\n\texports.compileSuccess = compileSuccess;\n\tvar browser = undefined;\n\t\n\tvar browserData = function browserData(data) {\n\t  browser.data = data;\n\t};\n\t\n\t// this is for using in runview\n\tfunction flintRuntimeError(message, file, line, col, error) {\n\t  browserData({ message: message, file: file, line: line, col: col, stack: error && error.stack });\n\t  // console.log('got err', message, file, line, col, error)\n\t  browser.emitter.emit('runtime:error');\n\t}\n\t\n\twindow.flintRuntimeError = flintRuntimeError;\n\t\n\tfunction run(b, opts) {\n\t  browser = b;\n\t\n\t  window.onViewLoaded = function () {\n\t    return browserData('success', null);\n\t  };\n\t}\n\t\n\tfunction compileError(error) {\n\t  if (error.loc) {\n\t    var message = error.message;\n\t    var fileName = error.fileName;\n\t    var loc = error.loc;\n\t    var stack = error.stack;\n\t\n\t    browserData({ message: message, stack: stack, file: fileName, line: loc.line, col: loc.column });\n\t  } else if (error.lineNumber) {\n\t    var message = error.message;\n\t    var stack = error.stack;\n\t    var fileName = error.fileName;\n\t    var lineNumber = error.lineNumber;\n\t    var column = error.column;\n\t\n\t    browserData({ message: message, stack: stack, file: fileName, line: lineNumber, col: column });\n\t  }\n\t}\n\t\n\tfunction compileSuccess() {\n\t  browserData(null);\n\t}\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\texports['default'] = run;\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\t\n\tvar _errors = __webpack_require__(1);\n\t\n\tvar _libFlintExt = __webpack_require__(3);\n\t\n\tvar _libFlintExt2 = _interopRequireDefault(_libFlintExt);\n\t\n\tvar _socket = __webpack_require__(4);\n\t\n\tvar _socket2 = _interopRequireDefault(_socket);\n\t\n\tfunction run(browser, opts) {\n\t  (0, _socket2['default'])(browser, opts, {\n\t    'editor:location': function editorLocation(msg) {\n\t      browser.editorLocation = msg;\n\t    },\n\t\n\t    'view:locations': function viewLocations(msg) {\n\t      browser.viewLocations = msg;\n\t    },\n\t\n\t    'script:add': function scriptAdd(msg) {\n\t      replaceScript(msg);\n\t    },\n\t\n\t    'stylesheet:add': function stylesheetAdd(msg) {\n\t      addSheet(msg.view);\n\t    },\n\t\n\t    'stylesheet:remove': function stylesheetRemove(msg) {\n\t      removeSheet(msg.view);\n\t    },\n\t\n\t    'compile:error': function compileError(msg) {\n\t      (0, _errors.compileError)(msg.error);\n\t    },\n\t\n\t    'compile:success': function compileSuccess(msg) {\n\t      (0, _errors.compileSuccess)();\n\t    },\n\t\n\t    'packages:reload': reloadScript('__flintExternals'),\n\t    'internals:reload': reloadScript('__flintInternals', { reloadAll: true }),\n\t\n\t    'file:delete': function fileDelete(_ref) {\n\t      var name = _ref.name;\n\t\n\t      var views = Flint.getFile(name);\n\t      views.map(removeSheet);\n\t      removeScript(name);\n\t\n\t      Flint.deleteFile(name);\n\t    },\n\t\n\t    'flint:opts': function flintOpts(opts) {\n\t      window.__flintopts = opts;\n\t    },\n\t\n\t    // coming from editor to browser\n\t\n\t    fromEditor: function fromEditor(_ref2) {\n\t      var key = _ref2.key;\n\t      var val = _ref2.val;\n\t\n\t      browser.editor = browser.editor || {};\n\t      browser.editor[key] = val;\n\t      browser.emitter.emit('editor:state');\n\t    }\n\t  });\n\t}\n\t\n\t// tag loader is a throttler\n\t// it accepts requests to load tags\n\t// and once those tags load, it will continue\n\t\n\tfunction TagLoader() {\n\t  var last = {};\n\t  var loading = {};\n\t  var wait = {};\n\t\n\t  return function (name, load) {\n\t    var oldTag = last[name];\n\t\n\t    if (loading[name]) {\n\t      wait[name] = true;\n\t      return;\n\t    }\n\t\n\t    loading[name] = true;\n\t\n\t    load(oldTag, onDone);\n\t\n\t    function onDone(newTag) {\n\t      last[name] = newTag;\n\t      loading[name] = false;\n\t\n\t      if (wait[name]) {\n\t        wait[name] = false;\n\t        load(last[name], onDone);\n\t      }\n\t    }\n\t  };\n\t}\n\t\n\t/*\n\t\n\t  This should be a closed async loop for hot loading files.\n\t\n\t  ws:add => addScript => tagloader => replaceTag =>\n\t    replaceTag => (tagLoader|null)\n\t\n\t*/\n\t\n\tvar scriptSelector = function scriptSelector(src) {\n\t  return 'script[src^=\"' + removeTime(removeBase(src)) + '\"]';\n\t};\n\tvar scriptUrl = function scriptUrl(name) {\n\t  return '/_/' + name + '.js';\n\t};\n\tvar findScript = function findScript(name) {\n\t  return document.querySelector(scriptSelector(scriptUrl(name)));\n\t};\n\t\n\tvar sheetSelector = function sheetSelector(href) {\n\t  return 'link[href^=\"' + removeTime(removeBase(href)) + '\"]';\n\t};\n\tvar sheetUrl = function sheetUrl(name) {\n\t  return '/__/styles/' + name + '.css';\n\t};\n\tvar findSheet = function findSheet(name) {\n\t  return document.querySelector(sheetSelector(sheetUrl(name)));\n\t};\n\t\n\tvar scrLoad = TagLoader();\n\tvar cssLoad = TagLoader();\n\t\n\tfunction addScript(src) {\n\t  var path = src.replace('/_/', '');\n\t  _socket2['default'].send('script:load', { path: path });\n\t  scrLoad(src, function (lastTag, done) {\n\t    lastTag = lastTag || document.querySelector(scriptSelector(src));\n\t\n\t    if (!lastTag) replaceTag(createScript(src), 'src', finish);else replaceTag(lastTag, 'src', finish);\n\t\n\t    function finish() {\n\t      _socket2['default'].send('script:done', { path: path });\n\t      done();\n\t    }\n\t  });\n\t}\n\t\n\tfunction addSheet(name) {\n\t  cssLoad(name, function (lastTag, done) {\n\t    lastTag = lastTag || findSheet(name);\n\t\n\t    if (!lastTag) replaceTag(createSheet(sheetUrl(name)), 'href', done);else replaceTag(lastTag, 'href', done);\n\t  });\n\t}\n\t\n\tfunction getParent(tag) {\n\t  if (tag.parentNode) return tag.parentNode;\n\t  if (tag.nodeName == 'SCRIPT') return document.body;else return document.head;\n\t}\n\t\n\tfunction replaceTag(tag, attr, after) {\n\t  if (!tag) return;\n\t\n\t  var parent = getParent(tag);\n\t  var clone = cloneNode(tag, attr);\n\t  var already = false;\n\t  var cielTimeout = undefined;\n\t\n\t  var afterFinish = function afterFinish() {\n\t    if (already) return;\n\t    clearTimeout(cielTimeout);\n\t    already = true;\n\t    setTimeout(function () {\n\t      removeTag(tag, parent, function () {\n\t        after && after(clone);\n\t      });\n\t    }, 4);\n\t  };\n\t\n\t  clone.onerror = afterFinish;\n\t  clone.onload = afterFinish;\n\t  parent.appendChild(clone);\n\t\n\t  // ceil of 250ms for slow loads\n\t  cielTimeout = setTimeout(function () {\n\t    if (already) return;\n\t    removeTag(tag, tag.parentNode, afterFinish, { leftover: 1 });\n\t  }, 200);\n\t}\n\t\n\tfunction removeTag(tag, parent, cb) {\n\t  var opts = arguments.length <= 3 || arguments[3] === undefined ? {} : arguments[3];\n\t  var leftover = opts.leftover;\n\t\n\t  leftover = typeof leftover == 'number' ? leftover : 2; // how many tags to leave\n\t\n\t  try {\n\t    parent.removeChild(tag);\n\t    setTimeout(cb, 2);\n\t  } catch (e) {\n\t    var isScript = tag.nodeName == 'SCRIPT';\n\t    var tags = document.querySelectorAll(isScript ? scriptSelector(tag.src) : sheetSelector(tag.href));\n\t\n\t    // attempt force removal\n\t    for (var i = 0; i < tags.length - leftover; i++) {\n\t      var _tag = tags[i];\n\t      try {\n\t        _tag.parentNode.removeChild(_tag);\n\t      } catch (e) {\n\t        try {\n\t          document.body.removeChild(_tag);\n\t          document.head.removeChild(_tag);\n\t        } catch (e) {/* oh well */}\n\t      }\n\t    }\n\t\n\t    // wait a bit longer after recovery\n\t    setTimeout(cb, 30);\n\t  }\n\t}\n\t\n\tfunction reloadScript(id) {\n\t  var opts = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\t\n\t  return function () {\n\t    var el = document.getElementById(id);\n\t    if (!el) return;\n\t\n\t    var finish = opts.reloadAll ? reloadAllScripts : renderFlint;\n\t    var tag = replaceTag(el, 'src', finish);\n\t  };\n\t}\n\t\n\tfunction replaceScript(_ref3, cb) {\n\t  var name = _ref3.name;\n\t  var timestamp = _ref3.timestamp;\n\t  var src = _ref3.src;\n\t\n\t  var jsName = (0, _libFlintExt2['default'])(name);\n\t  addScript(src || '/_' + jsName);\n\t}\n\t\n\tfunction reloadAllScripts() {\n\t  var scripts = document.querySelectorAll('.__flintScript');\n\t\n\t  if (!scripts.length) return;\n\t\n\t  var total = scripts.length;\n\t\n\t  _Flint.resetViewState();[].forEach.call(scripts, function (script) {\n\t    replaceTag(script, 'src');\n\t  });\n\t\n\t  // TODO: this should wait for all tags to be done loading\n\t  setTimeout(Flint.render, 10);\n\t}\n\t\n\tvar renderAttempts = 0;\n\t\n\tfunction renderFlint() {\n\t  if (renderAttempts > 10) {\n\t    renderAttempts = 0;\n\t    return;\n\t  }\n\t\n\t  if (typeof Flint != 'undefined') {\n\t    setTimeout(Flint.render);\n\t    renderAttempts = 0;\n\t  } else {\n\t    renderAttempts++;\n\t    setTimeout(renderFlint, 50);\n\t  }\n\t}\n\t\n\tfunction removeBase(str) {\n\t  return str.replace(/^http\\:\\/\\/[^/]+/, '');\n\t}\n\t\n\tfunction removeTime(str) {\n\t  return str.replace(/\\?[0-9]+$/, '');\n\t}\n\t\n\tfunction replaceTime(str) {\n\t  return removeTime(str) + ('?' + Date.now());\n\t}\n\t\n\tfunction createScript(src) {\n\t  var tag = document.createElement('script');\n\t  tag.src = src;\n\t  return tag;\n\t}\n\t\n\tfunction createSheet(href) {\n\t  var tag = document.createElement('link');\n\t  tag.href = href;\n\t  tag.rel = \"stylesheet\";\n\t  return tag;\n\t}\n\t\n\tfunction cloneNode(node, attr) {\n\t  var clone = undefined;\n\t\n\t  if (node.tagName != 'SCRIPT') {\n\t    clone = node.cloneNode(false);\n\t  } else {\n\t    clone = document.createElement('script');\n\t\n\t    var attrs = node.attributes;\n\t    for (var i = 0; i < attrs.length; i++) {\n\t      if (attrs[i].name != 'src') clone.setAttribute(attrs[i].name, attrs[i].value);\n\t    }\n\t  }\n\t\n\t  clone.setAttribute(attr, replaceTime(node.getAttribute(attr)));\n\t\n\t  return clone;\n\t}\n\t\n\tfunction removeSheet(name) {\n\t  var tag = findSheet(name);\n\t  if (tag && tag.parentNode) tag.parentNode.removeChild(tag);\n\t}\n\t\n\tfunction removeScript(name) {\n\t  var tag = findScript(name.replace('.js', ''));\n\t  if (tag && tag.parentNode) tag.parentNode.removeChild(tag);\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t// normalized flint extension, turning jsf -> js\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\t\n\texports['default'] = function (file) {\n\t  if (!file) return '';\n\t  var dots = file.split('.');\n\t  if (dots[dots.length - 1] === 'jsf') dots[dots.length - 1] = 'js';\n\t  return dots.join('.');\n\t};\n\t\n\tmodule.exports = exports['default'];\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, '__esModule', {\n\t  value: true\n\t});\n\texports['default'] = socket;\n\tvar opts = undefined;\n\tvar browser = undefined;\n\tvar actions = undefined;\n\t\n\tvar isOpening = false;\n\tvar isOpen = false;\n\tvar ws = null;\n\t\n\tfunction socket(_browser, _opts, _actions) {\n\t  opts = _opts;\n\t  browser = _browser;\n\t  actions = _actions;\n\t  open();\n\t\n\t  browser.messageEditor = function (obj) {\n\t    socket.send('editor', obj);\n\t  };\n\t}\n\t\n\tsocket.send = function send(type, obj) {\n\t  obj = obj || {};\n\t  obj._type = type;\n\t  ws.send(JSON.stringify(obj));\n\t};\n\t\n\tfunction open() {\n\t  console.flint('socket', 'open', 'isOpening', isOpening);\n\t  if (isOpening) return;\n\t  isOpening = true;\n\t\n\t  ws = new WebSocket('ws://localhost:' + opts.websocketPort + '/');\n\t  ws.onopen = onOpen;\n\t  ws.onmessage = onMessage;\n\t  ws.onerror = reconnect;\n\t  ws.onclose = reconnect;\n\t}\n\t\n\tfunction onOpen() {\n\t  isOpen = true;\n\t  isOpening = false;\n\t  reconnecting = false;\n\t}\n\t\n\tfunction onMessage(message) {\n\t  message = JSON.parse(message.data);\n\t  if (!message) return;\n\t  console.flint('socket', 'onMessage', 'message', message._type, message);\n\t\n\t  var action = actions[message._type];\n\t  if (action) action(message);\n\t\n\t  browser.data = message;\n\t  browser.emitter.emit(message._type);\n\t}\n\t\n\tvar tries = undefined;\n\tvar reconnecting = false;\n\t\n\tfunction reconnect() {\n\t  isOpening = false;\n\t  isOpen = false;\n\t\n\t  if (ws) ws.close();\n\t  if (reconnecting) return;\n\t  reconnecting = true;\n\t  tries = 0;\n\t  reconnector();\n\t}\n\t\n\tfunction reconnector() {\n\t  if (isOpen || tries > 50) return;\n\t\n\t  open();\n\t\n\t  // delay more and more in between\n\t  tries++;\n\t  var delay = tries * 1000;\n\t  setTimeout(reconnector, delay);\n\t}\n\tmodule.exports = exports['default'];\n\n/***/ }\n]);\n\n\n/** WEBPACK FOOTER **\n ** devtools.prod.js\n **/","import errors from './errors'\nimport messages from './messages'\nimport ee from 'event-emitter'\n\nconst emitter = ee({})\n\nwindow._DT = {\n  emitter,\n  data: null, // should be error\n  on(name, cb) { emitter.on(name, cb) }\n}\n\nconst opts = {\n  websocketPort: window._FLINT_WEBSOCKET_PORT\n}\n\nerrors(window._DT, opts)\nmessages(window._DT, opts)\n\n\n/** WEBPACK FOOTER **\n ** ./src/tools/main.js\n **/","let browser;\n\nconst browserData = data => {\n  browser.data = data;\n}\n\n// this is for using in runview\nfunction flintRuntimeError(message, file, line, col, error) {\n  browserData({ message, file, line, col, stack: error && error.stack });\n  // console.log('got err', message, file, line, col, error)\n  browser.emitter.emit('runtime:error')\n}\n\nwindow.flintRuntimeError = flintRuntimeError\n\nexport default function run(b, opts) {\n  browser = b;\n\n  window.onViewLoaded = () =>\n    browserData('success', null);\n}\n\nexport function compileError(error) {\n  if (error.loc) {\n    const { message, fileName, loc, stack } = error;\n    browserData({ message, stack, file: fileName, line: loc.line, col: loc.column });\n  }\n  else if (error.lineNumber) {\n    const { message, stack, fileName, lineNumber, column } = error;\n    browserData({ message, stack, file: fileName, line: lineNumber, col: column });\n  }\n}\n\nexport function compileSuccess() {\n  browserData(null);\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/tools/errors.js\n **/","import { compileError, compileSuccess } from './errors';\nimport removeFlintExt from '../lib/flintExt';\nimport socket from './socket'\n\nexport default function run(browser, opts) {\n  socket(browser, opts, {\n    'editor:location': msg => {\n      browser.editorLocation = msg\n    },\n\n    'view:locations': msg => {\n      browser.viewLocations = msg\n    },\n\n    'script:add': msg => {\n      replaceScript(msg)\n    },\n\n    'stylesheet:add': msg => {\n      addSheet(msg.view)\n    },\n\n    'stylesheet:remove': msg => {\n      removeSheet(msg.view)\n    },\n\n    'compile:error': msg => {\n      compileError(msg.error)\n    },\n\n    'compile:success': msg => {\n      compileSuccess()\n    },\n\n    'packages:reload': reloadScript('__flintExternals'),\n    'internals:reload': reloadScript('__flintInternals', { reloadAll: true }),\n\n    'file:delete': ({ name }) => {\n      let views = Flint.getFile(name)\n      views.map(removeSheet)\n      removeScript(name)\n\n      Flint.deleteFile(name)\n    },\n\n    'flint:opts': opts => {\n      window.__flintopts = opts\n    },\n\n\n    // coming from editor to browser\n\n    fromEditor: ({ key, val }) => {\n      browser.editor = browser.editor || {}\n      browser.editor[key] = val\n      browser.emitter.emit('editor:state')\n    }\n  })\n}\n\n// tag loader is a throttler\n// it accepts requests to load tags\n// and once those tags load, it will continue\n\nfunction TagLoader() {\n  let last = {}\n  let loading = {}\n  let wait = {}\n\n  return function(name, load) {\n    let oldTag = last[name]\n\n    if (loading[name]) {\n      wait[name] = true\n      return\n    }\n\n    loading[name] = true\n\n    load(oldTag, onDone)\n\n    function onDone(newTag) {\n      last[name] = newTag\n      loading[name] = false\n\n      if (wait[name]) {\n        wait[name] = false\n        load(last[name], onDone)\n      }\n    }\n  }\n}\n\n/*\n\n  This should be a closed async loop for hot loading files.\n\n  ws:add => addScript => tagloader => replaceTag =>\n    replaceTag => (tagLoader|null)\n\n*/\n\nconst scriptSelector = src => `script[src^=\"${removeTime(removeBase(src))}\"]`\nconst scriptUrl = name => `/_/${name}.js`\nconst findScript = name => document.querySelector(scriptSelector(scriptUrl(name)))\n\nconst sheetSelector = href => `link[href^=\"${removeTime(removeBase(href))}\"]`\nconst sheetUrl = name => `/__/styles/${name}.css`\nconst findSheet = name => document.querySelector(sheetSelector(sheetUrl(name)))\n\nconst scrLoad = TagLoader()\nconst cssLoad = TagLoader()\n\nfunction addScript(src) {\n  let path = src.replace('/_/', '')\n  socket.send('script:load', { path })\n  scrLoad(src, (lastTag, done) => {\n    lastTag = lastTag || document.querySelector(scriptSelector(src))\n\n    if (!lastTag)\n      replaceTag(createScript(src), 'src', finish)\n    else\n      replaceTag(lastTag, 'src', finish)\n\n    function finish() {\n      socket.send('script:done', { path })\n      done()\n    }\n  })\n}\n\nfunction addSheet(name) {\n  cssLoad(name, (lastTag, done) => {\n    lastTag = lastTag || findSheet(name)\n\n    if (!lastTag)\n      replaceTag(createSheet(sheetUrl(name)), 'href', done)\n    else\n      replaceTag(lastTag, 'href', done)\n  })\n}\n\nfunction getParent(tag) {\n  if (tag.parentNode) return tag.parentNode\n  if (tag.nodeName == 'SCRIPT') return document.body\n  else return document.head\n}\n\nfunction replaceTag(tag, attr, after) {\n  if (!tag) return\n\n  let parent = getParent(tag)\n  let clone = cloneNode(tag, attr)\n  let already = false\n  let cielTimeout\n\n  const afterFinish = () => {\n    if (already) return\n    clearTimeout(cielTimeout)\n    already = true\n    setTimeout(() => {\n      removeTag(tag, parent, () => {\n        after && after(clone)\n      })\n    }, 4)\n  }\n\n  clone.onerror = afterFinish\n  clone.onload = afterFinish\n  parent.appendChild(clone)\n\n  // ceil of 250ms for slow loads\n  cielTimeout = setTimeout(() => {\n    if (already) return\n    removeTag(tag, tag.parentNode, afterFinish, { leftover: 1 })\n  }, 200)\n}\n\nfunction removeTag(tag, parent, cb, opts = {}) {\n  let { leftover } = opts\n  leftover = typeof leftover == 'number' ? leftover : 2 // how many tags to leave\n\n  try {\n    parent.removeChild(tag)\n    setTimeout(cb, 2)\n  }\n  catch(e) {\n    const isScript = tag.nodeName == 'SCRIPT'\n    let tags = document.querySelectorAll(isScript ? scriptSelector(tag.src) : sheetSelector(tag.href))\n\n    // attempt force removal\n    for (let i = 0; i < tags.length - leftover; i++) {\n      const tag = tags[i]\n      try {\n        tag.parentNode.removeChild(tag)\n      }\n      catch(e) {\n        try {\n          document.body.removeChild(tag)\n          document.head.removeChild(tag)\n        }\n        catch(e) { /* oh well */ }\n      }\n    }\n\n    // wait a bit longer after recovery\n    setTimeout(cb, 30)\n  }\n}\n\nfunction reloadScript(id, opts = {}) {\n  return () => {\n    const el = document.getElementById(id)\n    if (!el) return\n\n    const finish = opts.reloadAll ? reloadAllScripts : renderFlint\n    const tag = replaceTag(el, 'src', finish)\n  }\n}\n\nfunction replaceScript({ name, timestamp, src }, cb) {\n  const jsName = removeFlintExt(name)\n  addScript(src || `/_${jsName}`)\n}\n\nfunction reloadAllScripts() {\n  const scripts = document.querySelectorAll('.__flintScript')\n\n  if (!scripts.length)\n    return\n\n  let total = scripts.length\n\n  _Flint.resetViewState()\n\n  ;[].forEach.call(scripts, script => {\n    replaceTag(script, 'src')\n  })\n\n  // TODO: this should wait for all tags to be done loading\n  setTimeout(Flint.render, 10)\n}\n\nlet renderAttempts = 0\n\nfunction renderFlint() {\n  if (renderAttempts > 10) {\n    renderAttempts = 0\n    return\n  }\n\n  if (typeof Flint != 'undefined') {\n    setTimeout(Flint.render)\n    renderAttempts = 0\n  }\n  else {\n    renderAttempts++\n    setTimeout(renderFlint, 50)\n  }\n}\n\nfunction removeBase(str) {\n  return str.replace(/^http\\:\\/\\/[^/]+/, '')\n}\n\nfunction removeTime(str) {\n  return str.replace(/\\?[0-9]+$/, '')\n}\n\nfunction replaceTime(str) {\n  return removeTime(str) + `?${Date.now()}`\n}\n\nfunction createScript(src) {\n  let tag = document.createElement('script')\n  tag.src = src\n  return tag\n}\n\nfunction createSheet(href) {\n  let tag = document.createElement('link')\n  tag.href = href\n  tag.rel = \"stylesheet\"\n  return tag\n}\n\nfunction cloneNode(node, attr) {\n  let clone\n\n  if (node.tagName != 'SCRIPT') {\n    clone = node.cloneNode(false)\n  }\n  else {\n    clone = document.createElement('script')\n\n    const attrs = node.attributes\n    for (let i = 0; i < attrs.length; i++)\n       if (attrs[i].name != 'src')\n         clone.setAttribute(attrs[i].name, attrs[i].value)\n  }\n\n  clone.setAttribute(attr, replaceTime(node.getAttribute(attr)))\n\n  return clone\n}\n\nfunction removeSheet(name) {\n  let tag = findSheet(name)\n  if (tag && tag.parentNode)\n    tag.parentNode.removeChild(tag)\n}\n\nfunction removeScript(name) {\n  let tag = findScript(name.replace('.js', ''))\n  if (tag && tag.parentNode)\n    tag.parentNode.removeChild(tag)\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tools/messages.js\n **/","// normalized flint extension, turning jsf -> js\nexport default function(file) {\n  if (!file) return ''\n  let dots = file.split('.')\n  if (dots[dots.length - 1] === 'jsf') dots[dots.length - 1] = 'js'\n  return dots.join('.')\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/lib/flintExt.js\n **/","let opts\nlet browser\nlet actions\n\nlet isOpening = false\nlet isOpen = false\nlet ws = null\n\nexport default function socket(_browser, _opts, _actions) {\n  opts = _opts\n  browser = _browser\n  actions = _actions\n  open()\n\n  browser.messageEditor = obj => {\n    socket.send('editor', obj)\n  }\n}\n\nsocket.send = function send(type, obj) {\n  obj = obj || {}\n  obj._type = type\n  ws.send(JSON.stringify(obj))\n}\n\nfunction open() {\n  console.flint('socket', 'open', 'isOpening', isOpening)\n  if (isOpening) return\n  isOpening = true\n\n  ws = new WebSocket('ws://localhost:' + opts.websocketPort + '/')\n  ws.onopen = onOpen\n  ws.onmessage = onMessage\n  ws.onerror = reconnect\n  ws.onclose = reconnect\n}\n\nfunction onOpen() {\n  isOpen = true\n  isOpening = false\n  reconnecting = false\n}\n\nfunction onMessage(message) {\n  message = JSON.parse(message.data)\n  if (!message) return\n  console.flint('socket', 'onMessage', 'message', message._type, message)\n\n  const action = actions[message._type]\n  if (action) action(message)\n\n  browser.data = message\n  browser.emitter.emit(message._type)\n}\n\nlet tries\nlet reconnecting = false\n\nfunction reconnect() {\n  isOpening = false\n  isOpen = false\n\n  if (ws) ws.close()\n  if (reconnecting) return\n  reconnecting = true\n  tries = 0\n  reconnector()\n}\n\nfunction reconnector() {\n  if (isOpen || tries > 50) return\n\n  open()\n\n  // delay more and more in between\n  tries++\n  let delay = tries * 1000\n  setTimeout(reconnector, delay)\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/tools/socket.js\n **/"],"sourceRoot":""}